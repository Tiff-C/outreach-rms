{% extends 'base.html' %}

{% load static %}

{% block extra_css %}
{{ block.super }}
    <link src="{% static 'css/stripe.css' %}"></link>
{% endblock %}

{% block page_header %}

{% endblock %}


{% block content %}
    <div class="container mt-4">
        <div class="row mb-4">
            <div class="col">
                <h1>Donations to Outreach RMS</h1>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <p>
                    Outreach RMS has been created and developed as an open source referral management system. The intended audience is Higher Education Providers, with a goal of creating a free platform that allows educational institutes to handle internal and external referrals with ease. Allowing for tracking of referrals in one place, rather than tracking in multiple spreadsheets, emails and documents.
                </p>
                <p>
                    If you have found this project useful to your team or if you would like to support the project and its goals please help us continue our work by making a donation.
                </p>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <form method="POST" id="payment-form" action="{% url 'donations' %}" class="align-items-center">
                    {% csrf_token %}
                    {{ donation_form.as_p }}
                    <div id="card-element">
                        <!-- Mount the Payment Element here -->
                    </div>
                    
                    <!-- Snip from Boutique Ado -->
                    <div class="mb-3 text-danger" id="card-errors" role="alert"></div>
                        <!-- Pass the client secret to the view so we can get the payment intent id -->
                    <input type="hidden" value="{{ client_secret }}" name="client_secret">


                    <button id="submit">
                        <div class="spinner hidden" id="spinner"></div>
                        <span id="button-text">Pay now</span>
                    </button>
                    <div id="payment-message" class="hidden"></div>
                    
                    <!-- <div>
                        <p>
                            <div class="submit-button text-right mt-5 mb-2">                    
                                <button id="submit-button" class="btn btn-black rounded-0">
                                    <span class="font-weight-bold">Complete Order</span>
                                    <span class="icon">
                                        <i class="fas fa-lock"></i>
                                    </span>
                                </button>
                                <p class="small text-danger my-0">
                                    <span class="icon">
                                        <i class="fas fa-exclamation-circle"></i>
                                    </span>
                                    <span>Your card will be charged <strong>${{ grand_total|floatformat:2 }}</strong></span>
                                </p>
                            </div>
                        </p>
                    </div> -->
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block postloadjs %}
    {{ block.super }}
    {{ stripe_public_key|json_script:"id_stripe_public_key" }}
    {{ client_secret|json_script:"id_client_secret" }}
    <script src="{% static 'js/stripe-element.js' %}"></script>
{% endblock %}